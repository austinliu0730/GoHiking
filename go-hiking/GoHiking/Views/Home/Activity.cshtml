@model List<GoHiking.ViewModels.ActivityViewModel>

@{
    ViewBag.Title = "Activity";
}

@section MyCSS{
    <link href="~/css/mycss/product.css?v=@DateTime.Now.Ticks" rel="stylesheet" />

}

<div class="product-page-container">
    <aside class="sidebar d-none d-lg-block">
        <h3 class="sidebar-title">活動總覽</h3>
        <p class="sidebar-subtitle">ACTIVITY</p>
        <ul class="activity-list">
            <li class="@(ViewBag.CurrentDays == null ? "active" : "")">
                <a href="@Url.Action("Activity")">所有活動</a>
            </li>
            <li class="@(ViewBag.CurrentDays == 1 ? "active" : "")">
                <a href="@Url.Action("Activity", new { days = 1 })">單日行程｜山林體驗</a>
            </li>
            <li class="@(ViewBag.CurrentDays == 2 ? "active" : "")">
                <a href="@Url.Action("Activity", new { days = 2 })">兩日行程｜深入荒野</a>
            </li>
            <li class="@(ViewBag.CurrentDays == 3 ? "active" : "")">
                <a href="@Url.Action("Activity", new { days = 3 })">三日行程｜拾回自然</a>
            </li>
            <li class="@(ViewBag.CurrentDays != null && ViewBag.CurrentDays >= 4 ? "active" : "")">
                <a href="@Url.Action("Activity", new { days = 4 })">四日以上｜浪漫忘返</a>
            </li>
        </ul>
        <br />
        <h3 class="sidebar-title">地區探索</h3>
        <p class="sidebar-subtitle">REGIONS</p>
        <ul class="activity-list">
            <li class="@(ViewBag.CurrentRegion == "北部" ? "active" : "")">
                <a href="@Url.Action("Activity", new { region = "北" })">北探|台北山水</a>
            </li>
            <li class="@(ViewBag.CurrentRegion == "中部" ? "active" : "")">
                <a href="@Url.Action("Activity", new { region = "中" })">中遊|山谷漫遊</a>
            </li>
            <li class="@(ViewBag.CurrentRegion == "南部" ? "active" : "")">
                <a href="@Url.Action("Activity", new { region = "南" })">南行|熱情南徑</a>
            </li>
            <li class="@(ViewBag.CurrentRegion == "東部" ? "active" : "")">
                <a href="@Url.Action("Activity", new { region = "東" })">東冒|綠野東行</a>
            </li>
        </ul>
    </aside>



    <main class="main-content">
        <div class="section">
            <div class="container">
                <div class="row">
                    @for (int i = 0; i < Model.Count; i++)
                    {
                        var activity = Model[i];
                        <div class="col-6 col-lg-4 mb-4" data-aos="fade-up" data-aos-delay="@((i + 1) * 100)">
                            <div class="media-entry">

                                <a href="@(activity.activity_id != 0
                                            ? Url.Action("Activity", "Products", new { id = activity.activity_id })
                                            : Url.Action("Details", "Products", new { id = activity.mt_id }))">

                                    @if (activity.activity_id != 0 && activity.ImageData != null && activity.ImageData.Length > 0)
                                    {
                                        <img src="data:image/jpeg;base64,@Convert.ToBase64String(activity.ImageData)"
                                             alt="@activity.mt_name" style="width: 390px; height: 200px; object-fit: cover;">
                                    }
                                    else
                                    {
                                        <img src="https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=900&h=400&fit=crop&crop=center"
                                             alt="@activity.mt_name" style="width: 390px; height: 200px; object-fit: cover;">
                                    }
                                </a>
                                <div class="bg-white m-body">
                                    <span class="date">@activity.walk_days 天</span>
                                    <h3><a href="@Url.Action("Details", new { id = activity.mt_name })">@activity.mt_name</a></h3>

                                    <div class="trail-info">
                                        <small class="text-muted">
                                            @if (activity.park_permit == 1)
                                            {
                                                <span class="badge bg-warning text-dark me-1">需入園證</span>
                                            }
                                            @if (activity.mt_permit == 1)
                                            {
                                                <span class="badge bg-danger me-1">需入山證</span>
                                            }
                                            @if (!string.IsNullOrEmpty(activity.badge))
                                            {
                                                <span class="badge bg-info">@activity.badge</span>
                                            }
                                        </small>
                                    </div>

                                    <div class="price-section mt-2 d-flex align-items-center">
                                        <strong class="text-primary">NT$ @activity.price.ToString("N0")</strong>
                                        <span class="mx-2">|</span>
                                        <div class="difficulty-stars">
                                            @for (int a = 1; a <= 5; a++)
                                            {
                                                <span class="star @(a <= Math.Max(1, activity.diff) ? "" : "inactive")"></span>
                                            }
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    }
                </div>


                <nav class="mt-5" aria-label="Page navigation example" data-aos="fade-up" data-aos-delay="100">
                    <ul class="custom-pagination pagination">
                        <!-- Previous 按鈕 -->
                        @if (ViewBag.CurrentPage > 1)
                        {
                            <li class="page-item prev">
                                <a class="page-link" href="@Url.Action("Activity", new {
                                       page = ViewBag.CurrentPage - 1,
                                       days = ViewBag.CurrentDays,
                                       region = ViewBag.CurrentRegion
                                   })">Previous</a>
                            </li>
                        }
                        else
                        {
                            <li class="page-item prev">
                                <span class="page-link">Previous</span>
                            </li>
                        }
                        <!-- 頁碼按鈕 -->
                        @for (int i = 1; i <= ViewBag.TotalPages; i++)
                        {
                            if (i == ViewBag.CurrentPage)
                            {
                                <li class="page-item active">
                                    <a class="page-link" href="#">@i</a>
                                </li>
                            }
                            else
                            {
                                <li class="page-item">
                                    <a class="page-link" href="@Url.Action("Activity", new {
                                       page = i,
                                       days = ViewBag.CurrentDays,
                                       region = ViewBag.CurrentRegion
                                })">@i</a>
                            </li>
                        }
                    }
                        <!-- Next 按鈕 -->
                        @if (ViewBag.CurrentPage < ViewBag.TotalPages)
                        {
                            <li class="page-item next">
                                <a class="page-link" href="@Url.Action("Activity", new {
                                   page = ViewBag.CurrentPage + 1,
                                   days = ViewBag.CurrentDays,
                                   region = ViewBag.CurrentRegion
                               })">Next</a>
                            </li>
                        }
                        else
                        {
                            <li class="page-item next disabled">
                                <span class="page-link">Next</span>
                            </li>
                        }
                    </ul>
                </nav>


            </div>
        </div>
    </main>
</div>

@section HeroSection {
    <div class="img-bg rellax">
        <img src="/images/backgroup.jpg" alt="Image" class="img-fluid">
    </div>

    <div class="container">
        <div class="row align-items-center justify-content-center">
            <div class="col-lg-5 text-center">
                <p data-aos="fade-up" style="color:#FFFFFF; font-size:16px;">
                    台灣登山行程｜專業媒合團隊
                </p>

                <br />
                <h1 data-aos="fade-up" style="color:#F0FFF0; display: inline-block;">
                    \ 活動總覽 /
                </h1>
                <p data-aos="fade-up" style="color:#FFFFFF; font-size:12px;">
                    ACTIVITY
                </p>

                <!-- 白色短線 -->
                <div style="width: 40px; height: 1px; background-color: #FFFFFF; margin: 1px auto;" data-aos="fade-up"></div>
                <br />
                <br />

                <p data-aos="fade-up" style="color:#FFFFFF; font-size:16px;">
                    從單日輕鬆健行到多日深度探險，為您規劃最適合的登山之旅。
                </p>
            </div>
        </div>
    </div>
}

@section MyJS{
    <script src="~/Scripts/jquery-3.7.1.js"></script>
    <script>
        $(() => {
            $('.activity-list a').hover(function () {
                $('.activity-list li').removeClass('active');
                $(this).parent('li').addClass('active');
            });
        });
    </script>
}